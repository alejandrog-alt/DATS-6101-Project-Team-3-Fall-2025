---
title: "DATS 6101-11 Introduction to Data Science: First Project"
author: "Team 3 : Alejandro, Ebrima, Vidyullatha"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: "cerulean"
    highlight: tango
    code_folding: show
    toc_depth: 3
    toc_float: yes
    toc: yes
    number_sections: true
    df_print: paged
---

```{r init, include=F}
# Frequently used functions are loadPkg(), xkabledply(), xkablesummary(), uzscale(), etc.
library(devtools)
library(ezids)
```


```{r setup, include=FALSE}
# Some of common RMD options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(results="markup", warning = F, message = F)
# Can globally set option for number display format.
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
```

# 1. Summary of the dataset 

**Load the dataset into R**
```{r}
library(readr)
studperf <- read_csv("StudentsPerformance.csv")
```

**Display the first 5 records**
```{r}
head(studperf, 5)
```

```{r}
```


**Structure of dataset (variable types)**
```{r}
str(studperf)
```

**Basic summary statistics**
```{r}
summary(studperf)
xkablesummary(studperf)
```

**Column names and unique values**
```{r}
names(studperf)
sapply(studperf, function(x) length(unique(x)))
```


# 2. Descriptive statistics

**How many observations are in this data set?**
```{r, echo=TRUE}
length(studperf)
nrow(studperf)
dim(studperf)
```
**Answer:** The number of observations in this data set is `r nrow(studperf)`.

**How many observations having missing (NA) values?**
```{r}
sum(is.na(studperf$weekly_self_study_hours))
sum(is.na(studperf$attendance_percentage))
sum(is.na(studperf$class_participation))
sum(is.na(studperf$total_score))
```
**Answer:** There are no missing values.

**Converting `grade` to a factor variable**
```{r, echo=TRUE}
studperf$grade <- as.factor(studperf$grade)
summary(studperf)
```

**Looking at new summary statistics nicely: Using the ezids package**

```{r, echo=TRUE}
xkablesummary(studperf['weekly_self_study_hours'], title = "Weekly Self Study Hours")
xkablesummary(studperf['attendance_percentage'], title = "Attendance Percentage")
xkablesummary(studperf['class_participation'], title = "Class Participation")
xkablesummary(studperf['total_score'], title = "Total Score")
xkablesummary(studperf['grade'], title = "Grade")
```

# 3. Graphical representations of the data

**Including Plots**
```{r echo=TRUE}

library(ggplot2)

ggplot(data=studperf, aes(x=weekly_self_study_hours) ) + 
geom_histogram(  col="white", 
                 fill="orange", 
                 alpha = .8, # opacity
                 bins = 50) + 
  labs(
        x="Weekly Self Study Hours", 
        y="Frequency",
        title="Histogram of Weekly Self Study Hours in student performance Dataset") 

ggplot( data=studperf, aes(x=attendance_percentage) ) + 
geom_histogram(  col="white", 
                 fill="blue", 
                 alpha = .8, # opacity
                 bins = 50) + 
  labs(
        x="Attendance Percentage", 
        y="Frequency",
        title="Histogram of Attendance Percentage in df Dataset") 

ggplot( data=studperf, aes(x=total_score) ) + 
geom_histogram(  col="white", 
                 fill="blue", 
                 alpha = .8, # opacity
                 bins = 50) + 
  labs(
        x="Total Score", 
        y="Frequency",
        title="Histogram of Total Score in student performance Dataset") 


ggplot(studperf, aes(y = class_participation) ) +
  geom_boxplot( colour = "orange",       
                fill   = "#7777cc",      
                outlier.colour = "red",  # outlier points color
                outlier.shape  = 6,      # outlier symbol
                outlier.size   = 3       # outlier point size
               ) +
  labs(
        title = "Boxplot of Class Participation in student performance Dataset",
        x = "",
        y = "Class Participation"
  )
```

**Removing outliers**
```{r echo=TRUE}

studperf2 = outlierKD2(studperf, weekly_self_study_hours, qqplt = TRUE)
studperf3 = outlierKD2(studperf2, attendance_percentage, qqplt = TRUE)
studperf4 = outlierKD2(studperf3, class_participation, qqplt = TRUE)
studperf5 = outlierKD2(studperf4, total_score, qqplt = TRUE)

qqnorm(studperf2$weekly_self_study_hours, main = "QQ Plot of Weekly Self Study Hours (outliers removed)")
qqline(studperf2$weekly_self_study_hours, col = "red")

qqnorm(studperf3$attendance_percentage, main = "QQ Plot of Attendance Percentage (outliers removed)")
qqline(studperf3$attendance_percentage, col = "red")

qqnorm(studperf4$class_participation, main = "QQ Plot of Class Participation (outliers removed)")
qqline(studperf4$class_participation, col = "blue")

qqnorm(studperf5$total_score, main = "QQ Plot of Total Score (outliers removed)")
qqline(studperf5$total_score, col = "blue")

```


**A Scatterplot between Weekly Self Study Hours and Class Participation, with points colored by Grade **
```{r echo=TRUE}

ggplot(studperf, aes(x =weekly_self_study_hours , y = class_participation, color = grade)) +
  geom_point(size = 3, alpha = 0.7) +
  labs(
    title = "Scatterplot of Weekly Self Study Hours and Class Participation Colored by Grade",
    x = "Weekly Self Study Hours",
    y = "Class Participation",
    color = "Grade"
  ) +
  theme_minimal()
```



